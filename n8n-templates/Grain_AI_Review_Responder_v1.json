{
  "name": "Grain AI Review Responder v1",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes",
              "minutesInterval": 30
            }
          ]
        }
      },
      "id": "review-check-trigger",
      "name": "Check Reviews Every 30min",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [240, 300]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "review-responder/new-review",
        "options": {}
      },
      "id": "webhook-new-review",
      "name": "Webhook: New Review",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1.1,
      "position": [240, 500]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "google_place_id",
              "value": "YOUR_GOOGLE_PLACE_ID"
            },
            {
              "name": "tripadvisor_location_id",
              "value": "YOUR_TRIPADVISOR_ID"
            },
            {
              "name": "business_name",
              "value": "ƒ∞≈ületme Adƒ±nƒ±z"
            },
            {
              "name": "business_phone",
              "value": "+90 XXX XXX XX XX"
            },
            {
              "name": "manager_email",
              "value": "manager@isletme.com"
            },
            {
              "name": "auto_respond_threshold",
              "value": "4"
            },
            {
              "name": "response_language",
              "value": "tr"
            }
          ]
        },
        "options": {}
      },
      "id": "config-settings",
      "name": "Configuration",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.2,
      "position": [480, 400]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "=https://maps.googleapis.com/maps/api/place/details/json?place_id={{$json.google_place_id}}&fields=name,rating,reviews,user_ratings_total&language={{$json.response_language}}&key={{$credentials.googlePlacesApi.apiKey}}",
        "options": {}
      },
      "id": "fetch-google-reviews",
      "name": "Fetch Google Reviews",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [720, 300]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "=https://api.tripadvisor.com/api/partner/2.0/location/{{$json.tripadvisor_location_id}}/reviews?key={{$credentials.tripadvisorApi.apiKey}}&lang={{$json.response_language}}",
        "options": {}
      },
      "id": "fetch-tripadvisor-reviews",
      "name": "Fetch TripAdvisor Reviews",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [720, 500]
    },
    {
      "parameters": {
        "jsCode": "// Yorumlarƒ± normalize et ve filtrele\nconst allReviews = [];\nconst now = new Date();\nconst oneDayAgo = new Date(now - 24 * 60 * 60 * 1000);\n\nfor (const item of $input.all()) {\n  const data = item.json;\n  \n  // Google Reviews\n  if (data.result?.reviews) {\n    for (const review of data.result.reviews) {\n      const reviewDate = new Date(review.time * 1000);\n      if (reviewDate > oneDayAgo) {\n        allReviews.push({\n          platform: 'Google',\n          platform_icon: 'üîµ',\n          review_id: `google_${review.time}`,\n          author: review.author_name,\n          avatar: review.profile_photo_url,\n          rating: review.rating,\n          text: review.text || '(Sadece puan verildi)',\n          date: reviewDate.toISOString(),\n          language: review.language || 'tr',\n          needs_response: true\n        });\n      }\n    }\n  }\n  \n  // TripAdvisor Reviews  \n  if (data.data) {\n    for (const review of data.data) {\n      const reviewDate = new Date(review.published_date);\n      if (reviewDate > oneDayAgo) {\n        allReviews.push({\n          platform: 'TripAdvisor',\n          platform_icon: 'üü¢',\n          review_id: review.id,\n          author: review.user?.username || 'Anonim',\n          avatar: review.user?.avatar?.small?.url,\n          rating: review.rating,\n          text: review.text,\n          title: review.title,\n          date: reviewDate.toISOString(),\n          language: review.lang || 'en',\n          needs_response: true\n        });\n      }\n    }\n  }\n}\n\nif (allReviews.length === 0) {\n  return [{ json: { message: 'Son 24 saatte yeni yorum yok', count: 0 } }];\n}\n\nreturn allReviews.map(r => ({ json: r }));"
      },
      "id": "normalize-reviews",
      "name": "Normalize Reviews",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [960, 400]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "has-reviews",
              "leftValue": "={{$json.needs_response}}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "filter-new-reviews",
      "name": "Filter New Reviews",
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2,
      "position": [1200, 400]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{$json.rating}}",
                    "rightValue": 4,
                    "operator": {
                      "type": "number",
                      "operation": "gte"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Positive"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{$json.rating}}",
                    "rightValue": 3,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Neutral"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{$json.rating}}",
                    "rightValue": 2,
                    "operator": {
                      "type": "number",
                      "operation": "lte"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Negative"
            }
          ]
        },
        "options": {}
      },
      "id": "route-by-sentiment",
      "name": "Route by Sentiment",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [1440, 400]
    },
    {
      "parameters": {
        "model": "gpt-4o",
        "options": {
          "temperature": 0.7,
          "maxTokens": 400
        },
        "messages": {
          "values": [
            {
              "role": "system",
              "content": "Sen profesyonel bir i≈ületme m√º≈üteri ili≈ükileri uzmanƒ±sƒ±n. Olumlu m√º≈üteri yorumlarƒ±na sƒ±cak, samimi ve ki≈üiselle≈ütirilmi≈ü yanƒ±tlar yazƒ±yorsun.\n\n## Kurallar:\n1. M√º≈üteriye ismiyle hitap et (Deƒüerli X Bey/Hanƒ±m)\n2. Yorumda bahsettikleri spesifik konulara deƒüin\n3. Te≈üekk√ºr et ve memnuniyetini belirt\n4. Tekrar davet et\n5. Emoji kullan ama abartma (2-3 emoji yeterli)\n6. Maksimum 100 kelime\n7. T√ºrk√ße yaz\n8. Sonunda \"ƒ∞≈ületme Ekibi\" imzasƒ± ekle\n\n## √ñrnek Yanƒ±t:\n\"Deƒüerli [ƒ∞sim] Bey/Hanƒ±m, g√ºzel yorumunuz i√ßin √ßok te≈üekk√ºr ederiz! [Spesifik konuya deƒüinme]. Sizin gibi deƒüerli misafirlerimizi aƒüƒ±rlamak bizim i√ßin b√ºy√ºk mutluluk. Tekrar g√∂r√º≈ümek dileƒüiyle! üôè‚ú® - ƒ∞≈ületme Ekibi\""
            },
            {
              "role": "user",
              "content": "Platform: {{$json.platform}}\nM√º≈üteri: {{$json.author}}\nPuan: {{$json.rating}}/5 ‚≠ê\nYorum: {{$json.text}}\n{{$json.title ? 'Ba≈ülƒ±k: ' + $json.title : ''}}\n\nBu olumlu yoruma uygun bir yanƒ±t yaz."
            }
          ]
        }
      },
      "id": "ai-positive-reply",
      "name": "AI: Positive Reply",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.4,
      "position": [1680, 200],
      "credentials": {
        "openAiApi": {
          "id": "openai-cred",
          "name": "OpenAI API"
        }
      }
    },
    {
      "parameters": {
        "model": "gpt-4o",
        "options": {
          "temperature": 0.6,
          "maxTokens": 400
        },
        "messages": {
          "values": [
            {
              "role": "system",
              "content": "Sen profesyonel bir i≈ületme m√º≈üteri ili≈ükileri uzmanƒ±sƒ±n. N√∂tr (3 yƒ±ldƒ±z) m√º≈üteri yorumlarƒ±na dengeli, yapƒ±cƒ± ve geli≈üime a√ßƒ±k yanƒ±tlar yazƒ±yorsun.\n\n## Kurallar:\n1. M√º≈üteriye ismiyle hitap et\n2. Zaman ayƒ±rƒ±p yorum yazdƒ±klarƒ± i√ßin te≈üekk√ºr et\n3. Olumlu y√∂nlere deƒüin (varsa)\n4. Geli≈ütirilecek alanlar i√ßin geri bildirimi dikkate aldƒ±ƒüƒ±nƒ± belirt\n5. Daha iyi bir deneyim sunma s√∂z√º ver\n6. Maksimum 100 kelime\n7. T√ºrk√ße yaz\n8. Sonunda \"ƒ∞≈ületme Ekibi\" imzasƒ± ekle"
            },
            {
              "role": "user",
              "content": "Platform: {{$json.platform}}\nM√º≈üteri: {{$json.author}}\nPuan: {{$json.rating}}/5 ‚≠ê\nYorum: {{$json.text}}\n{{$json.title ? 'Ba≈ülƒ±k: ' + $json.title : ''}}\n\nBu n√∂tr yoruma uygun bir yanƒ±t yaz."
            }
          ]
        }
      },
      "id": "ai-neutral-reply",
      "name": "AI: Neutral Reply",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.4,
      "position": [1680, 400],
      "credentials": {
        "openAiApi": {
          "id": "openai-cred",
          "name": "OpenAI API"
        }
      }
    },
    {
      "parameters": {
        "model": "gpt-4o",
        "options": {
          "temperature": 0.4,
          "maxTokens": 500
        },
        "messages": {
          "values": [
            {
              "role": "system",
              "content": "Sen profesyonel bir i≈ületme kriz y√∂netimi uzmanƒ±sƒ±n. Olumsuz m√º≈üteri yorumlarƒ±na empatik, √ß√∂z√ºm odaklƒ± ve profesyonel yanƒ±tlar yazƒ±yorsun.\n\n## MUTLAK KURALLAR:\n1. ASLA savunmacƒ± olma veya mazeret √ºretme\n2. M√º≈üteriye Sayƒ±n/Deƒüerli ismiyle hitap et\n3. Ya≈üanan deneyim i√ßin i√ßtenlikle √∂z√ºr dile\n4. Spesifik soruna deƒüin (varsa)\n5. Konuyu √∂zel olarak ele almak istediƒüini belirt\n6. ƒ∞leti≈üim numarasƒ± ver: {{$('Configuration').first().json.business_phone}}\n7. √á√∂z√ºm s√∂z√º ver\n8. Maksimum 120 kelime\n9. T√ºrk√ße yaz\n10. Sonunda \"ƒ∞≈ületme M√ºd√ºr√º\" imzasƒ± ekle\n11. Emoji KULLANMA (ciddi bir durum)\n\n## √ñrnek Yanƒ±t:\n\"Sayƒ±n [ƒ∞sim] Bey/Hanƒ±m, ya≈üadƒ±ƒüƒ±nƒ±z deneyim i√ßin √ßok √ºzg√ºn√ºz. [Spesifik soruna deƒüinme]. Bu kesinlikle sizin hak ettiƒüiniz hizmet kalitesini yansƒ±tmƒ±yor. Durumu acilen incelemek ve sizinle konu≈ümak istiyoruz. L√ºtfen [telefon] numarasƒ±ndan bize ula≈üƒ±r mƒ±sƒ±nƒ±z? Saygƒ±larƒ±mƒ±zla, ƒ∞≈ületme M√ºd√ºr√º\""
            },
            {
              "role": "user",
              "content": "Platform: {{$json.platform}}\nM√º≈üteri: {{$json.author}}\nPuan: {{$json.rating}}/5 ‚≠ê\nYorum: {{$json.text}}\n{{$json.title ? 'Ba≈ülƒ±k: ' + $json.title : ''}}\n\nBu olumsuz yoruma empatik ve √ß√∂z√ºm odaklƒ± bir yanƒ±t yaz."
            }
          ]
        }
      },
      "id": "ai-negative-reply",
      "name": "AI: Negative Reply",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.4,
      "position": [1680, 600],
      "credentials": {
        "openAiApi": {
          "id": "openai-cred",
          "name": "OpenAI API"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "id": "merge-responses",
      "name": "Merge All Responses",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 2.1,
      "position": [1920, 400]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "response-data",
              "name": "response_package",
              "value": "={\n  \"review_id\": \"{{$json.review_id}}\",\n  \"platform\": \"{{$json.platform}}\",\n  \"platform_icon\": \"{{$json.platform_icon}}\",\n  \"author\": \"{{$json.author}}\",\n  \"rating\": {{$json.rating}},\n  \"original_review\": \"{{$json.text}}\",\n  \"ai_response\": \"{{$json.message?.content || $json.text}}\",\n  \"sentiment\": \"{{$json.rating >= 4 ? 'positive' : ($json.rating === 3 ? 'neutral' : 'negative')}}\",\n  \"auto_post\": {{$json.rating >= 4}},\n  \"needs_approval\": {{$json.rating <= 2}},\n  \"generated_at\": \"{{new Date().toISOString()}}\"\n}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "format-response",
      "name": "Format Response Package",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.2,
      "position": [2160, 400]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "needs-approval-check",
              "leftValue": "={{JSON.parse($json.response_package).needs_approval}}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "check-approval-needed",
      "name": "Needs Approval?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [2400, 400]
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "YOUR_GOOGLE_SHEET_ID",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "AI Yanƒ±tlar",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Tarih": "={{new Date().toLocaleString('tr-TR')}}",
            "Platform": "={{JSON.parse($json.response_package).platform}}",
            "M√º≈üteri": "={{JSON.parse($json.response_package).author}}",
            "Puan": "={{JSON.parse($json.response_package).rating}}",
            "Yorum": "={{JSON.parse($json.response_package).original_review}}",
            "AI Yanƒ±t": "={{JSON.parse($json.response_package).ai_response}}",
            "Durum": "Otomatik G√∂nderildi",
            "Sentiment": "={{JSON.parse($json.response_package).sentiment}}"
          },
          "matchingColumns": [],
          "schema": []
        },
        "options": {}
      },
      "id": "log-auto-response",
      "name": "Log Auto Response",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.3,
      "position": [2640, 300]
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "YOUR_GOOGLE_SHEET_ID",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Onay Bekleyenler",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Tarih": "={{new Date().toLocaleString('tr-TR')}}",
            "Platform": "={{JSON.parse($json.response_package).platform}}",
            "M√º≈üteri": "={{JSON.parse($json.response_package).author}}",
            "Puan": "={{JSON.parse($json.response_package).rating}}",
            "Yorum": "={{JSON.parse($json.response_package).original_review}}",
            "AI Yanƒ±t √ñnerisi": "={{JSON.parse($json.response_package).ai_response}}",
            "Durum": "Onay Bekliyor",
            "Onay": "Hayƒ±r"
          },
          "matchingColumns": [],
          "schema": []
        },
        "options": {}
      },
      "id": "add-approval-queue",
      "name": "Add to Approval Queue",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.3,
      "position": [2640, 500]
    },
    {
      "parameters": {
        "sendTo": "={{$('Configuration').first().json.manager_email}}",
        "subject": "=‚ö†Ô∏è Olumsuz Yorum - Onay Gerekli | {{JSON.parse($json.response_package).platform}}",
        "emailType": "html",
        "message": "=<!DOCTYPE html>\n<html>\n<head>\n<style>\nbody { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; }\n.container { max-width: 600px; margin: 0 auto; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }\n.header { background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; padding: 20px; text-align: center; }\n.content { padding: 25px; }\n.review-box { background: #fef5f5; border-left: 4px solid #e74c3c; padding: 15px; margin: 15px 0; border-radius: 4px; }\n.ai-box { background: #f0fff4; border-left: 4px solid #27ae60; padding: 15px; margin: 15px 0; border-radius: 4px; }\n.meta { color: #666; font-size: 14px; margin-bottom: 10px; }\n.rating { font-size: 24px; }\n.btn { display: inline-block; background: #3498db; color: white; padding: 12px 25px; text-decoration: none; border-radius: 5px; margin: 5px; }\n.btn-approve { background: #27ae60; }\n.btn-edit { background: #f39c12; }\n.footer { background: #f8f9fa; padding: 15px; text-align: center; font-size: 12px; color: #666; }\n</style>\n</head>\n<body>\n<div class=\"container\">\n<div class=\"header\">\n<h2>‚ö†Ô∏è Olumsuz Yorum Bildirimi</h2>\n<p>Hƒ±zlƒ± yanƒ±t gerekiyor!</p>\n</div>\n<div class=\"content\">\n<p class=\"meta\">üìç Platform: <strong>{{JSON.parse($json.response_package).platform}}</strong></p>\n<p class=\"meta\">üë§ M√º≈üteri: <strong>{{JSON.parse($json.response_package).author}}</strong></p>\n<p class=\"rating\">‚≠ê Puan: {{JSON.parse($json.response_package).rating}}/5</p>\n\n<h3>üí¨ M√º≈üteri Yorumu:</h3>\n<div class=\"review-box\">\n{{JSON.parse($json.response_package).original_review}}\n</div>\n\n<h3>ü§ñ AI Yanƒ±t √ñnerisi:</h3>\n<div class=\"ai-box\">\n{{JSON.parse($json.response_package).ai_response}}\n</div>\n\n<div style=\"text-align: center; margin-top: 25px;\">\n<a href=\"#approve\" class=\"btn btn-approve\">‚úÖ Onayla ve G√∂nder</a>\n<a href=\"#edit\" class=\"btn btn-edit\">‚úèÔ∏è D√ºzenle</a>\n</div>\n</div>\n<div class=\"footer\">\nBu e-posta Grain AI Review Responder tarafƒ±ndan otomatik g√∂nderilmi≈ütir.\n</div>\n</div>\n</body>\n</html>",
        "options": {}
      },
      "id": "send-approval-email",
      "name": "Send Approval Email",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [2880, 500],
      "credentials": {
        "gmailOAuth2": {
          "id": "gmail-cred",
          "name": "Gmail OAuth2"
        }
      }
    },
    {
      "parameters": {
        "channel": "#reviews",
        "text": "=üîî *Yeni Yorum Yanƒ±tlandƒ±*\n\n{{JSON.parse($json.response_package).platform_icon}} *Platform:* {{JSON.parse($json.response_package).platform}}\nüë§ *M√º≈üteri:* {{JSON.parse($json.response_package).author}}\n‚≠ê *Puan:* {{JSON.parse($json.response_package).rating}}/5\n\nüí¨ *Yorum:*\n> {{JSON.parse($json.response_package).original_review}}\n\n‚úçÔ∏è *AI Yanƒ±t:*\n> {{JSON.parse($json.response_package).ai_response}}\n\n‚úÖ Durum: Otomatik g√∂nderildi",
        "otherOptions": {}
      },
      "id": "slack-auto-notify",
      "name": "Slack: Auto Response Sent",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.1,
      "position": [2880, 300],
      "credentials": {
        "slackApi": {
          "id": "slack-cred",
          "name": "Slack API"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// G√ºnl√ºk √∂zet raporu olu≈ütur\nconst reviews = $input.all().map(i => {\n  try {\n    return JSON.parse(i.json.response_package);\n  } catch(e) {\n    return i.json;\n  }\n});\n\nconst summary = {\n  date: new Date().toLocaleDateString('tr-TR'),\n  total_reviews: reviews.length,\n  by_platform: {},\n  by_sentiment: {\n    positive: 0,\n    neutral: 0,\n    negative: 0\n  },\n  auto_responded: 0,\n  needs_approval: 0,\n  avg_rating: 0\n};\n\nlet totalRating = 0;\n\nreviews.forEach(r => {\n  // Platform count\n  summary.by_platform[r.platform] = (summary.by_platform[r.platform] || 0) + 1;\n  \n  // Sentiment count\n  if (r.rating >= 4) summary.by_sentiment.positive++;\n  else if (r.rating === 3) summary.by_sentiment.neutral++;\n  else summary.by_sentiment.negative++;\n  \n  // Auto response vs approval\n  if (r.auto_post) summary.auto_responded++;\n  if (r.needs_approval) summary.needs_approval++;\n  \n  totalRating += r.rating;\n});\n\nsummary.avg_rating = reviews.length > 0 \n  ? (totalRating / reviews.length).toFixed(1) \n  : 0;\n\nconst report = `\nüìä *G√ºnl√ºk Yorum √ñzeti* - ${summary.date}\n\nüìù Toplam Yorum: *${summary.total_reviews}*\n‚≠ê Ortalama Puan: *${summary.avg_rating}/5*\n\nüìà *Daƒüƒ±lƒ±m:*\n‚úÖ Olumlu: ${summary.by_sentiment.positive}\n‚ûñ N√∂tr: ${summary.by_sentiment.neutral}\n‚ùå Olumsuz: ${summary.by_sentiment.negative}\n\nü§ñ *Otomasyon:*\n‚úì Otomatik yanƒ±tlanan: ${summary.auto_responded}\n‚è≥ Onay bekleyen: ${summary.needs_approval}\n\nüìç *Platform Daƒüƒ±lƒ±mƒ±:*\n${Object.entries(summary.by_platform).map(([p, c]) => `‚Ä¢ ${p}: ${c}`).join('\\n')}\n`;\n\nreturn [{ json: { summary, report } }];"
      },
      "id": "generate-summary",
      "name": "Generate Daily Summary",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2160, 600]
    },
    {
      "parameters": {
        "channel": "#daily-reports",
        "text": "={{$json.report}}",
        "otherOptions": {}
      },
      "id": "send-daily-summary",
      "name": "Slack: Daily Summary",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.1,
      "position": [2400, 600],
      "credentials": {
        "slackApi": {
          "id": "slack-cred",
          "name": "Slack API"
        }
      }
    }
  ],
  "connections": {
    "Check Reviews Every 30min": {
      "main": [
        [
          {
            "node": "Configuration",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook: New Review": {
      "main": [
        [
          {
            "node": "Configuration",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Configuration": {
      "main": [
        [
          {
            "node": "Fetch Google Reviews",
            "type": "main",
            "index": 0
          },
          {
            "node": "Fetch TripAdvisor Reviews",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Google Reviews": {
      "main": [
        [
          {
            "node": "Normalize Reviews",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch TripAdvisor Reviews": {
      "main": [
        [
          {
            "node": "Normalize Reviews",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Normalize Reviews": {
      "main": [
        [
          {
            "node": "Filter New Reviews",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter New Reviews": {
      "main": [
        [
          {
            "node": "Route by Sentiment",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Route by Sentiment": {
      "main": [
        [
          {
            "node": "AI: Positive Reply",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI: Neutral Reply",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI: Negative Reply",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI: Positive Reply": {
      "main": [
        [
          {
            "node": "Merge All Responses",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI: Neutral Reply": {
      "main": [
        [
          {
            "node": "Merge All Responses",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI: Negative Reply": {
      "main": [
        [
          {
            "node": "Merge All Responses",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge All Responses": {
      "main": [
        [
          {
            "node": "Format Response Package",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format Response Package": {
      "main": [
        [
          {
            "node": "Needs Approval?",
            "type": "main",
            "index": 0
          },
          {
            "node": "Generate Daily Summary",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Needs Approval?": {
      "main": [
        [
          {
            "node": "Add to Approval Queue",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Log Auto Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Log Auto Response": {
      "main": [
        [
          {
            "node": "Slack: Auto Response Sent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Add to Approval Queue": {
      "main": [
        [
          {
            "node": "Send Approval Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate Daily Summary": {
      "main": [
        [
          {
            "node": "Slack: Daily Summary",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "saveExecutionProgress": true
  },
  "meta": {
    "templateId": "grain_ai_review_responder_v1",
    "templateName": "Grain AI Review Responder",
    "templateVersion": "1.0.0",
    "templateDescription": "Google ve TripAdvisor yorumlarƒ±nƒ± AI ile otomatik yanƒ±tlama - Olumlu/Olumsuz ayrƒ±mƒ±, onay sistemi, g√ºnl√ºk raporlama",
    "categories": ["review_management", "ai_automation", "customer_service"],
    "author": "Grain AI Team",
    "created": "2024-01-20",
    "keywords": ["review", "ai response", "google", "tripadvisor", "automation", "customer service"]
  },
  "tags": [
    {"name": "review-management"},
    {"name": "ai-automation"},
    {"name": "customer-service"},
    {"name": "grain-premium"}
  ]
}
